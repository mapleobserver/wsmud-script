// ç”Ÿæˆç»ƒä¹ ä»£ç ï¼Œè‡ªåŠ¨å¡«å…¥ç³»ç»Ÿè®¾ç½®ä¸­ï¼Œä»£ç é•¿åº¦æœ€å¤š200ã€‚
// å››åŒºç™½ä¸‰ä¸‰
($localVer) = 2021041901
($changeLog) = ä¿®æ”¹ä»£ç å­—ç¬¦æœ€å¤§å€¼ä¸º300ï¼›ä¿å­˜ç»ƒä¹ æˆ¿é—´çš„é€‰æ‹©ï¼›ä¿®æ­£æŠ€èƒ½æ•°é‡æœ€å¤§å€¼ä¸º62
($repourl) = https://cdn.jsdelivr.net/gh/mapleobserver/wsmud-script
@js ($version) = $.ajax({type: "GET", url: "(repourl)/version.txt", async: false, cache: false}).responseText;
//@print (version)
@js ($remoteVer) = var v = (version);v.lxdm
[if] (localVer) != (remoteVer)
  @js WG.SendCmd("tm å½“å‰ç»ƒä¹ ä»£ç ç”Ÿæˆå™¨ç‰ˆæœ¬ã€(localVer)ã€‘ï¼Œå°†å¼€å§‹è‡ªåŠ¨æ›´æ–°è‡³æœ€æ–°ã€(remoteVer)ã€‘ã€‚")
  ($f_ss)={"name":"ç»ƒä¹ ä»£ç ç”Ÿæˆå™¨","source":"(repourl)/æå‡/ç»ƒä¹ ä»£ç ç”Ÿæˆå™¨.flow.txt","finder":"æå‡"}
  @js var time = Date.parse( new Date());var f=(f_ss);var n=f["name"];var s=f["source"];var fd=f["finder"];WorkflowConfig.removeWorkflow({"name":n,"type":"flow","finder":fd});$.get(s,{stamp:time},function(data,status){WorkflowConfig.createWorkflow(n,data,fd);});
  @wait 1000
  ($log) = ç»ƒä¹ ä»£ç ç”Ÿæˆå™¨å·²æ›´æ–°è‡³æœ€æ–°ç‰ˆã€(remoteVer)ã€‘ï¼Œå³å°†è‡ªåŠ¨è¿è¡Œã€‚æœ¬æ¬¡æ›´æ–°å†…å®¹ï¼š(changeLog)
  @js WG.SendCmd("tm (log)")
  @print <ord>(log)</ord>
  @js var f=(f_ss);ManagedPerformerCenter.start(f["name"], FlowStore.get(f["name"]));
  [exit]
[else]
  ($log) = å¼€å§‹è¿è¡Œç»ƒä¹ ä»£ç ç”Ÿæˆå™¨ï¼Œå½“å‰ç‰ˆæœ¬ã€(remoteVer)ã€‘ã€‚æ›´æ–°å†…å®¹ï¼š(changeLog)
  @js WG.SendCmd("tm (log)")
  @print <ord>(log)</ord>

@toolbar jh
//è·å–å¢ƒç•Œ
[while] (jj) == null
  @toolbar score
  @js ($jj) = $(`span[data-prop=level]`).text()
//è·å–ç­‰çº§ä¸Šé™
[while] (level) == null
  @toolbar skills
  @js ($level) = /\d+/.exec($(".obj-money").text())['0']

//é€‰æ‹©ç»ƒä¹ æ–¹å¼
[(LXtype)==null]($LXtype)=ç»ƒè‡³ä¸Šé™
#select ($LXtype) = ç»ƒä¹ æ–¹å¼,æŒ‡å®šç­‰çº§|ç»ƒè‡³ä¸Šé™,(LXtype)
#config
($reset) = true
[while] true
  [if] (len) != null && (len) > 300
    ($len) = 0
    ($list) = null
    #input ($info) = <ord>ç»ƒä¹ ä»£ç å¤ªé•¿æ— æ³•ä¿å­˜ï¼Œè¯·é‡æ–°é€‰æ‹©</ord>,ğŸ‘‡ğŸ‘‡ğŸ‘‡
  //åˆ¤æ–­æ˜¯å¦åœ¨å‰¯æœ¬ä¸­
  @js ($fb) = '(:room)'.indexOf('å‰¯æœ¬åŒºåŸŸ')
  //é€‰æ‹©æ˜¯å¦æ·»åŠ æˆ¿é—´ä»£ç 
  [(LX_map)==null]($LX_map)=ä½æˆ¿-ç»ƒåŠŸæˆ¿
  [(fb)!=-1]($LX_map)=ä¸åŠ 
  #select ($LX_map) = æ˜¯å¦æ·»åŠ å‰å¾€æˆ¿é—´çš„ä»£ç ,ä¸åŠ |ä½æˆ¿-ç»ƒåŠŸæˆ¿|å¸®ä¼š-ç»ƒåŠŸæˆ¿,(LX_map)
  //é€‰æ‹©ç»ƒä¹ ç»“æŸååŠ¨ä½œ
  [(lx_after)==null]($lx_after)=æŒ–çŸ¿
  [if] (jj) == æ­¦å¸ || (jj) == æ­¦ç¥
    ($lx_after) = é—­å…³
  [(fb)!=-1]($lx_after)=ä¸åŠ 
  #select ($lx_after) = æ˜¯å¦æ·»åŠ ç»ƒä¹ ç»“æŸåå‘½ä»¤,ä¸åŠ |é—­å…³|æŒ–çŸ¿,(lx_after)
  //é€‰æ‹©éœ€è¦ç»ƒä¹ çš„æŠ€èƒ½
  #input ($target_level) = å½“å‰æŠ€èƒ½ä¸Šé™,(level)
  ($_i) = 0
  [while] (_i) < 62
    @js ($s(_i)) = $(".skill-item").eq('(_i)').attr('skid')
    [if] (s(_i)) == null
      [break]
    @js ($n(_i)) = $(".skill-item").eq('(_i)').html().match(/[^\d]*/)
    @js ($n(_i)) = '(n(_i))'.replace(/span class="skill-level"/,'')
    @js ($n(_i)) = '(n(_i))'.replace(/<>/, '')
    //@js ($n(_i)) = '(n(_i))'.replace(/âœ”/, '')
    @js ($ln(_i)) = $(".skill-item").eq('(_i)').text().match(/[0-9]+/)
    [if] (s(_i)) != literate && (s(_i)) != lianyao
      [if] (LXtype) == æŒ‡å®šç­‰çº§
        #input ($l(_i)) = (n(_i))å½“å‰ç­‰çº§(ln(_i)),(ln(_i))
      [else]
        #select ($k(_i)) = (n(_i))å½“å‰ç­‰çº§(ln(_i)),ç»ƒä¹ |è·³è¿‡,è·³è¿‡
    ($_i) = (_i) + 1
  #config

  // ç”Ÿæˆä»£ç 
  ($_j) = 0
  @print (s(_j)),(l(_j))
  [while] (_j) < (_i)
    [if] (s(_j))==force || (s(_j))==unarmed || (s(_j))==dodge || (s(_j))==parry || (s(_j))==sword || (s(_j))==blade || (s(_j))==whip || (s(_j))==throwing || (s(_j))==staff || (s(_j))==club || (s(_j))==bite
      ($type) = base
    [else]
      ($type) = skill
    [if] (LXtype) == æŒ‡å®šç­‰çº§
      [if] (l(_j)) != null && (l(_j)) > (ln(_j))
        [if] (list) != null
          [if] (type) == base
            @js ($list) = 'lianxi '+'(s(_j))'+' '+'(l(_j))'+','+'(list)'
          [else]
            @js ($list) = '(list)'+',lianxi '+'(s(_j))'+' '+'(l(_j))'
        [else]
          ($list) = lianxi (s(_j)) (l(_j))
    [else]
      [if] (k(_j)) != è·³è¿‡ && (k(_j)) != null
        [if] (list) != null
          [if] (type) == base
            @js ($list) = 'lianxi '+'(s(_j))'+','+'(list)'
          [else]
            @js ($list) = '(list)'+',lianxi '+'(s(_j))'
        [else]
          ($list) = lianxi (s(_j))
    ($_j) = (_j)+1
  [if] (list) != null
    //æ·»åŠ åœ°å›¾å‘½ä»¤
    [(fb)!=-1](LX_map)=ä¸åŠ 
    [if] (LX_map) != ä¸åŠ 
      [if] (LX_map) == ä½æˆ¿-ç»ƒåŠŸæˆ¿
        @js ($map) = 'jh fam 0 start,go west,go west,go north,go enter,go west,'
      [else]
        @js ($map) = 'jh fam 0 start,go south,go south,go east,go east,go east,go north,'
    [else]
      ($map) = null
    [if] (map) != null
      @js ($list) = '(map)'+'(list)'
    //æ·»åŠ ç»ƒä¹ ç»“æŸåå‘½ä»¤
    [if] (lx_after) != ä¸åŠ 
      [(lx_after)==é—­å…³]($after)=xiulian
      [(lx_after)==æŒ–çŸ¿]($after)=wakuang
      @js ($list) = '(list)'+','+'(after)'
    @print (list)
    @js ($len) = '(list)'.length
    [if] (len) > 300
      [continue]
    [else]
      setting auto_work (list);
      @print <ord>æ–°ç»ƒä¹ ä»£ç å·²ç”Ÿæ•ˆï¼š</ord>
      @print <hiy>(list)</hiy>
      @print <ord>æ‰“åå³å¯æŒ‰ç…§æ–°ä»£ç å¼€å§‹ç»ƒä¹ ï¼Œç³»ç»Ÿè®¾ç½®æ˜¾ç¤ºå†…å®¹éœ€åˆ·æ–°ç½‘é¡µæ‰èƒ½çœ‹è§ã€‚</ord>
  [else]
    @print <ord>æœªè®¾å®šä»»ä½•æŠ€èƒ½ï¼</ord>
  [break]