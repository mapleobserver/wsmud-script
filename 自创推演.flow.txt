//~silent
//åŸºäºå¤šä¸ªç‰ˆæœ¬æ•´åˆä¿®æ”¹ï¼Œä¸ºæ­¤æ‰å¤´å‘çš„äººï¼šç™½ä¸‰ä¸‰ã€å¤§ğŸ”ã€å‘†å‘å¤©å¤©ã€é»‘ç™½éƒå›ã€å†·æ‰‹ç¡¬æ‰“ã€æ¸…å’Œï¼Œä»¥åŠå‡ ä½ä¸çŸ¥åæˆ–å¿˜è®°åå­—çš„å¤§ä½¬ã€‚
($localVer) = 2021101802
($changeLog) = ğŸ†• æ½œèƒ½ä¸è¶³è¯æ¡ä¸‹ä¸€æ¬¡å‡çº§ä¼šè‡ªåŠ¨åœæ­¢ï¼›å¢åŠ è¯æ¡å±æ€§æŸ¥çœ‹æŒ‰é’®ï¼›å¢åŠ å†…åŠŸéœ‡æ…‘è¯æ¡ï¼ˆå¾…æµ‹è¯•ï¼‰ã€å†…åŠŸç‰¹æ®Šè¯æ¡åŒ–æ¯’ã€æ‹›æ¶ç‰¹æ®Šè¯æ¡ä¸“æ³¨å’Œæ˜Ÿç§»ã€‚ğŸŒŸ 1.è·å–è¯æ¡ç­‰çº§ã€‚2.æ¨æ¼”æ½œèƒ½è·å–å’Œè®¡ç®—ã€‚3.å¯å¹³å‡æˆ–ä¼˜å…ˆæ¨æ¼”æŒ‡å®šåºå·çš„è¯æ¡ã€‚4.è®¾å®šè¯æ¡æŒ‡å®šç­‰çº§ã€‚5.æ¨æ¼”æ—¶å¯å¼€å¯è‡ªåŠ¨é‡è¿ã€‚6.å¢åŠ åœæ­¢æ¨æ¼”æŒ‰é’®ï¼ˆå¸ˆé—¨æŒ‰é’®æ—ï¼‰ã€‚7.è¯­éŸ³æé†’ã€‚
($flowName) = è‡ªåˆ›æ¨æ¼”
($flowCode) = zcty
($flowPath) = æ ¹æ–‡ä»¶å¤¹
($flowFinder) = æ ¹æ–‡ä»¶å¤¹
//($repourl) = https://cdn.jsdelivr.net/gh/mapleobserver/wsmud-script
($repourl) = http://wsmud-cdn.if404.com
@js ($version) = $.ajax({type: "GET", url: "(repourl)/version.txt", async: false, cache: false}).responseText;
[if] (version) != null
  @js ($remoteVer) = var v = (version);v.(flowCode)
[if] (localVer) < (remoteVer) && (remoteVer) != null
  [if] (UPnum) == null
    ($UPnum) = 0
  [if] (UPnum) < 2
    [if] (UPnum) == 1
      @print æœªè·å–åˆ°æœ€æ–°ç‰ˆæœ¬ï¼Œä½¿ç”¨å¤‡ç”¨åœ°å€å†æ¬¡å°è¯•...
      ($repourl) = http://wsmud-cdn.if404.com
    ($UPnum) = (UPnum) + 1
    [if] (flowPath) != æ ¹æ–‡ä»¶å¤¹ && (flowPath) != null
      ($flowSource) = (repourl)/(flowPath)/(flowName).flow.txt
    [else]
      ($flowSource) = (repourl)/(flowName).flow.txt
    [if] (flowFinder) == null
      ($flowFinder) = æ ¹æ–‡ä»¶å¤¹
    @js WG.SendCmd("tm å½“å‰(flowName)ç‰ˆæœ¬ã€(localVer)ã€‘ï¼Œå°†å¼€å§‹è‡ªåŠ¨æ›´æ–°è‡³æœ€æ–°ã€(remoteVer)ã€‘ã€‚")
    ($f_ss)={"name":"(flowName)","source":"(flowSource)","finder":"(flowFinder)"}
    @js var time = Date.parse( new Date());var f=(f_ss);var n=f["name"];var s=f["source"];var fd=f["finder"];WorkflowConfig.removeWorkflow({"name":n,"type":"flow","finder":fd});$.get(s,{stamp:time},function(data,status){WorkflowConfig.createWorkflow(n,data,fd);});
    @wait 1500
    ($log) = âœ…(flowName)å·²æ›´æ–°è‡³æœ€æ–°ç‰ˆã€(remoteVer)ã€‘ï¼Œå³å°†è‡ªåŠ¨è¿è¡Œã€‚
  [else]
    ($log) = â­•(flowName)æš‚æ—¶æ— æ³•æ­£å¸¸æ›´æ–°è‡³ã€(remoteVer)ã€‘ï¼Œç›´æ¥è¿è¡Œå½“å‰ç‰ˆæœ¬ã€(localVer)ã€‘ã€‚
    ($UPnum) = null
  @js WG.SendCmd("tm (log)")
  @print <ord>(log)</ord>
  [if] (UPnum) != null
    @js var f=(f_ss);ManagedPerformerCenter.start(f["name"], FlowStore.get(f["name"]));
    [exit]
[else]
  ($UPnum) = null
  [if] (remoteVer) == null
    ($log) = âš ï¸è·å–è¿œç¨‹ç‰ˆæœ¬å¤±è´¥ï¼Œç»´æŒå½“å‰ç‰ˆæœ¬ä¸å˜ã€‚
  [else]
    ($log) = ğŸš€å¼€å§‹è¿è¡Œ(flowName)ï¼Œå½“å‰ç‰ˆæœ¬ã€(remoteVer)ã€‘ã€‚æ›´æ–°å†…å®¹ï¼š(changeLog)
  @js WG.SendCmd("tm (log)")
  @print <ord>(log)</ord>

// æµç¨‹
@cmdDelay 0
[if] (ZCFood) == null
  ($ZCFood)=æ˜¯
[if] (ZCFy) == null
  ($ZCFy)=æ˜¯
[if] (ZCSkill) == null
  ($ZCSkill)=å†…åŠŸ
[if] (ZCMaxqn) == null
  ($ZCMaxqn)=100000
[if] (ZCProp) == null
  ($ZCProp)=å¿½è§†å¯¹æ–¹é˜²å¾¡|æœ€ç»ˆä¼¤å®³|æš´å‡»|ç»æ‹›å†·å´æ—¶é—´%
[if] (ZCSpc) == null
  ($ZCSpc)=çŸ­æ—¶é—´æ— è§†ä¼¤å®³
[if] (ZCXlu) == null
  ($ZCXlu)=æ— 
[if] (ZCxl) == null
  ($ZCxl)=æ˜¯
[if] (TYPriorNum) == null || (TYPriorNum) == 10
  ($TYPriorNum)=å¹³å‡
[if] (ZCEntryLv) == null
  ($ZCEntryLv)=0
[if] (ZCAlertType) == null
  ($ZCAlertType)=å…³é—­
[if] (ZCAlertWay) == null
  ($ZCAlertWay)=æç¤ºéŸ³
[if] (AlertTel) == null
  ($AlertTel)=å¼€å¯

#select ($zcEntrySet)=å½“å‰è¯æ¡è®¾ç½®ï¼š<br/>&nbsp*&nbsp<hiz>å¦‚æœè¦é‡æ–°è®¾å®šè¯æ¡ï¼Œå…ˆé€‰æ‹©æ¨æ¼”éƒ¨ä½ï¼Œ<ord>ç„¶åç›´æ¥ç‚¹è¿è¡Œè¿›å…¥è¯æ¡è®¾ç½®ç•Œé¢</ord>ğŸ‘‡ï¼‰</hiz>,æ­£å¸¸æ¨æ¼”|é‡è®¾è¯æ¡|æ¸…ç©ºé‡æ¨,æ­£å¸¸æ¨æ¼”
#select ($ZCSkill)=è¦æ¨æ¼”çš„æŠ€èƒ½éƒ¨ä½,å†…åŠŸ|é­æ³•|æ£æ³•|å‰‘æ³•|åˆ€æ³•|æ–æ³•|æ‹›æ¶|æ‹³è„š|æš—å™¨|è½»åŠŸ,(ZCSkill)
#select ($TYPriorNum)=æ¨æ¼”æ–¹å¼æä¾›ä¸¤ç§é€‰æ‹©ï¼š<br/>&nbsp*&nbsp1ï¸âƒ£ å¹³å‡æå‡æ‰€æœ‰è¯æ¡ç­‰çº§ï¼›<br/>&nbsp*&nbsp2ï¸âƒ£ æŒ‡å®šä¼˜å…ˆæ¨æ¼”æŒ‡å®šè¯æ¡ï¼ˆä»ä¸Šåˆ°ä¸‹6ä¸ªè¯æ¡é€‰1ä¸ªï¼‰<br/>&nbsp*&nbspè¯·é€‰æ‹©æ¨æ¼”æ–¹å¼,å¹³å‡|1|2|3|4|5|6,(TYPriorNum)
#input ($ZCEntryLv)=è¯æ¡é™å®šç­‰çº§ï¼ˆæ‰€æœ‰æˆ–æŒ‡å®šè¯æ¡æ¨åˆ°è¯¥ç­‰çº§ååœæ­¢ï¼Œå¡«0ä¸ºä¸é™åˆ¶ï¼‰,(ZCEntryLv)
#input ($ZCProp)=<hiz>ä¸Šæ¬¡æ™®é€šè¯æ¡è®¾ç½®ä¸ºï¼š(ZCProp)</hiz><br/>&nbsp*&nbspæ™®é€šè¯æ¡(å®Œå…¨åŒ¹é…ï¼Œç”¨|éš”å¼€ï¼Œé™ç™¾åˆ†æ¯”ååŠ %ï¼Œé™éç™¾åˆ†æ¯”åŠ d),(ZCProp)
#input ($ZCSpc)=ç‰¹æ®Šè¯æ¡(æ¨¡ç³ŠåŒ¹é…),(ZCSpc)
#select ($ZCxl)=<hiz>å‡ºç‰¹æ®Šè¯æ¡åé—­å…³</hiz>,æ˜¯|å¦,(ZCxl)
#input ($ZCMaxqn)=æ€»æ¶ˆè€—æ½œèƒ½(ä¸‡),(ZCMaxqn)
#select ($ZCFood)=å†°å¿ƒ,æ˜¯|å¦,(ZCFood)
#select ($ZCFy)=é£ç¿¼,æ˜¯|å¦,(ZCFy)
#select ($ZCXlu)=é¦™ç‚‰,æ— |æ²‰é¦™æœ¨é¼|éºé¦™é“œé¼|é¾™æ¶é¦™ç†|é¾™è„‘å¤é¼,(ZCXlu)
#select ($relogin)=<hio>å¼€å¯è‡ªåŠ¨é‡è¿é˜²æ­¢æ‰çº¿</hio>,å¼€å¯|å…³é—­,å¼€å¯
#select ($ZCAlertType)=æ¨å‡ºè¯æ¡å’Œç»“æŸæ—¶å‘å‡ºé€šçŸ¥,å…¨éƒ¨é€šçŸ¥|ç»“æŸæ—¶é€šçŸ¥|å…³é—­,(ZCAlertType)
#select ($ZCAlertWay)=é€šçŸ¥æ–¹å¼,è¯­éŸ³æ’­æŠ¥|æç¤ºéŸ³,(ZCAlertWay)
#select ($AlertTel)=æ˜¯å¦å¼€å¯è¿œç¨‹é€šçŸ¥,å¼€å¯|å…³é—­,(AlertTel)
#config

// é…ç½®è¯æ¡
[if] (zcEntrySet)==é‡è®¾è¯æ¡
  [if] (ZCSkill)==å†…åŠŸ
    ($propAry)=ä¸æ¨æ¼”|è‡‚åŠ›d|å‘½ä¸­d|æ”»å‡»%|å‘½ä¸­%|æœ€ç»ˆä¼¤å®³%|å¿½è§†å¯¹æ–¹é˜²å¾¡%|ç»æ‹›å†·å´æ—¶é—´%|æš´å‡»%|ç»ƒä¹ æ•ˆç‡%|æ”»å‡»é€Ÿåº¦%|å†…åŠ›æ¶ˆè€—%|ä¼¤å®³å‡å…%|é˜²å¾¡%|æ‹›æ¶%|èº²é—ª%|æ°”è¡€%|æš´å‡»ä¼¤å®³%|æš´å‡»æŠµæŠ—%|å¿™ä¹±%|å¿½è§†å¿™ä¹±%|ç»æ‹›é‡Šæ”¾æ—¶é—´%|å­¦ä¹ æ•ˆç‡%|æ‰“åæ•ˆç‡%|æ”»å‡»d|ç»æ‹›å†·å´æ—¶é—´d|æ”»å‡»é€Ÿåº¦d|ç»æ‹›é‡Šæ”¾æ—¶é—´d|å¿™ä¹±d|æ ¹éª¨d|èº«æ³•d|æ‚Ÿæ€§d|é˜²å¾¡d|æ‹›æ¶d|èº²é—ªd|éœ‡æ…‘ï¼ˆé•¿ç”Ÿï¼‰|éœ‡æ…‘ï¼ˆæ…ˆèˆªï¼‰|éœ‡æ…‘ï¼ˆæˆ˜ç¥ï¼‰
    ($spcAry)=ä¸æ¨æ¼”|å¸è¡€ï¼ˆå¤ªç„ï¼‰|ä¸ç­ï¼ˆæ··æ²Œï¼‰|æˆ˜ç¥|åéœ‡|å®ˆæŠ¤|å‰‘å¿ƒ|åŒ–æ¯’
  [else if] (ZCSkill)==é­æ³• || (ZCSkill)==æ£æ³• || (ZCSkill)==å‰‘æ³• || (ZCSkill)==åˆ€æ³• || (ZCSkill)==æ–æ³• || (ZCSkill)==æ‹³è„š || (ZCSkill)==æš—å™¨
    ($propAry)=ä¸æ¨æ¼”|æ”»å‡»d|å‘½ä¸­d|è‡‚åŠ›d|æ”»å‡»%|å‘½ä¸­%|æœ€ç»ˆä¼¤å®³%|å¿½è§†å¯¹æ–¹é˜²å¾¡%|æš´å‡»%|å†…åŠ›æ¶ˆè€—%|ä¼¤å®³å‡å…%|é˜²å¾¡%|æ‹›æ¶%|èº²é—ª%|æ°”è¡€%|æš´å‡»ä¼¤å®³%|æš´å‡»æŠµæŠ—%|å¿™ä¹±%|å¿½è§†å¿™ä¹±%|æ ¹éª¨d|èº«æ³•d|æ‚Ÿæ€§d|é˜²å¾¡d|æ‹›æ¶d|èº²é—ªd
    ($spcAry)=ä¸æ¨æ¼”|å¼±åŒ–|æº…å°„|å¸è¡€|ç©¿é€|æ— æƒ…|å—œè¡€|å†…ä¼¤ï¼ˆå…¥é­”ï¼‰
  [else if] (ZCSkill)==æ‹›æ¶
    ($propAry)=ä¸æ¨æ¼”|æ”»å‡»d|å‘½ä¸­d|è‡‚åŠ›d|å‘½ä¸­%|æ ¹éª¨d|èº«æ³•d|æ‚Ÿæ€§d|é˜²å¾¡d|æ‹›æ¶d|èº²é—ªd|æš´å‡»ä¼¤å®³%|å†…åŠ›æ¶ˆè€—%|ç»ƒä¹ æ•ˆç‡%|å­¦ä¹ æ•ˆç‡%|æ‰“åæ•ˆç‡%|é˜²å¾¡%|æ‹›æ¶%|èº²é—ª%|æ°”è¡€%
    ($spcAry)=ä¸æ¨æ¼”|åå‡»ï¼ˆç§»èŠ±ï¼‰|ä¹¾å¤|çºµæ¨ª|æ˜Ÿç§»|ä¸“æ³¨ï¼ˆæ‹›æ¶ï¼‰
  [else if] (ZCSkill)==è½»åŠŸ
    ($propAry)=ä¸æ¨æ¼”|æ”»å‡»d|è‡‚åŠ›d|å‘½ä¸­d|å‘½ä¸­%|é˜²å¾¡d|æ‹›æ¶d|èº²é—ªd|æ ¹éª¨d|èº«æ³•d|æ‚Ÿæ€§d|é˜²å¾¡%|æ‹›æ¶%|èº²é—ª%|æ°”è¡€%|æš´å‡»ä¼¤å®³%|å†…åŠ›æ¶ˆè€—%|ç»ƒä¹ æ•ˆç‡%|å­¦ä¹ æ•ˆç‡%|æ‰“åæ•ˆç‡%
    ($spcAry)=ä¸æ¨æ¼”|åå‡»|çµåŠ¨|ä¸“æ³¨ï¼ˆè½»åŠŸï¼‰
  #select ($entry1)=<hiz>å½“å‰é€‰æ‹©éƒ¨ä½ï¼š</hiz><ord>ğŸ‘‰(ZCSkill)ğŸ‘ˆ</ord><br/>&nbsp*&nbspæ™®é€šè¯æ¡1,(propAry),(entry1)
  #select ($entry2)=æ™®é€šè¯æ¡2,(propAry),(entry2)
  #select ($entry3)=æ™®é€šè¯æ¡3,(propAry),(entry3)
  #select ($entry4)=æ™®é€šè¯æ¡4,(propAry),(entry4)
  #select ($entry5)=æ™®é€šè¯æ¡5ï¼ˆæœ‰ç‰¹æ®Šè¯æ¡å¯é€‰ä¸æ¨æ¼”ï¼‰,(propAry),(entry5)
  #select ($entryspc)=ç‰¹æ®Šè¯æ¡ï¼ˆä¸éœ€è¦åˆ™é€‰ä¸æ¨æ¼”ï¼‰,(spcAry),(entryspc)
  #config

  // å¤„ç†è¯æ¡è®¾ç½®
  [(entry1)==null]($entry1)=ä¸æ¨æ¼”
  [(entry2)==null]($entry2)=ä¸æ¨æ¼”
  [(entry3)==null]($entry3)=ä¸æ¨æ¼”
  [(entry4)==null]($entry4)=ä¸æ¨æ¼”
  [(entryspc)==null]($entryspc)=ä¸æ¨æ¼”
  ($ZCProp) = (entry1)|(entry2)|(entry3)|(entry4)
  [if] (entry5) != ä¸æ¨æ¼” && (entry5) != null && (entryspc) == ä¸æ¨æ¼”
    ($ZCProp) = (ZCProp)|(entry5)
  [if] (entryspc)==ä¸æ¨æ¼”
    ($ZCSpc) = ä¸æ¨æ¼”
  [else]
    [if] (entryspc)==å¸è¡€ï¼ˆå¤ªç„ï¼‰
      ($ZCSpc)=æ”»å‡»åŠ›çš„å†…åŠŸä¼¤å®³
    [else if] (entryspc)==ä¸ç­ï¼ˆæ··æ²Œï¼‰
      ($ZCSpc)=çŸ­æ—¶é—´æ— è§†ä¼¤å®³
    [else if] (entryspc)==æˆ˜ç¥
      ($ZCSpc)=ç©ºæ‰‹æ—¶é™„åŠ çš„å†…åŠ›åŠ å€
    [else if] (entryspc)==åéœ‡
      ($ZCSpc)=æœ€å¤§å†…åŠ›çš„åéœ‡ä¼¤å®³
    [else if] (entryspc)==å®ˆæŠ¤
      ($ZCSpc)=æ°”è¡€æ¯é™ä½
    [else if] (entryspc)==å‰‘å¿ƒ
      ($ZCSpc)=é¢å¤–æ”»å‡»æ•Œäºº
    [else if] (entryspc)==å¼±åŒ–
      ($ZCSpc)=æˆ˜æ–—å±æ€§
    [else if] (entryspc)==æº…å°„
      ($ZCSpc)=å¯¹é™„è¿‘ä¸€åæ•Œäºº
    [else if] (entryspc)==å¸è¡€
      ($ZCSpc)=è½¬åŒ–ä¸ºè‡ªèº«æ°”è¡€
    [else if] (entryspc)==ç©¿é€
      ($ZCSpc)=ä¼¤å®³å¢åŠ 
    [else if] (entryspc)==æ— æƒ…
      ($ZCSpc)=æ•Œäººçš„æ°”è¡€æ¯é™ä½
    [else if] (entryspc)==å—œè¡€
      ($ZCSpc)=ä½ çš„æ°”è¡€æ¯é™ä½
    [else if] (entryspc)==å†…ä¼¤ï¼ˆå…¥é­”ï¼‰
      ($ZCSpc)=é™„åŠ ä½ æœ€å¤§å†…åŠ›
    [else if] (entryspc)==åå‡»ï¼ˆç§»èŠ±ï¼‰
      ($ZCSpc)=æ‹›æ¶æˆåŠŸåé¡ºåŠ¿åå‡»æ•Œäºº
    [else if] (entryspc)==ä¹¾å¤
      ($ZCSpc)=ä¼¤å®³å‡å…
    [else if] (entryspc)==çºµæ¨ª
      ($ZCSpc)=æ‹›æ¶æˆåŠŸåå¢åŠ 
    [else if] (entryspc)==åå‡»
      ($ZCSpc)=èº²é—ªæˆåŠŸåé¡ºåŠ¿åå‡»æ•Œäºº
    [else if] (entryspc)==çµåŠ¨
      ($ZCSpc)=èº²é—ªæˆåŠŸåå¢åŠ 
    [else if] (entryspc)==ä¸“æ³¨ï¼ˆè½»åŠŸï¼‰
      ($ZCSpc)=æˆ˜æ–—ä¸­æå‡èº²é—ª
    [else if] (entryspc)==ä¸“æ³¨ï¼ˆæ‹›æ¶ï¼‰
      ($ZCSpc)=æˆ˜æ–—ä¸­æå‡æ‹›æ¶
    [else if] (entryspc)==åŒ–æ¯’
      ($ZCSpc)=å¸å–å¯¹æ–¹å†…åŠ›
    [else if] (entryspc)==æ˜Ÿç§»
      ($ZCSpc)=æ‹›æ¶æˆåŠŸåå°†æ‰€å—ä¼¤å®³

  @await 500
  @print è®¾å®šå®Œæ¯•ï¼Œå‡†å¤‡é‡å¯æµç¨‹...
  @js ManagedPerformerCenter.start("è‡ªåˆ›æ¨æ¼”", FlowStore.get("è‡ªåˆ›æ¨æ¼”"));
  @print é‡å¯æµç¨‹ã€‚
  [exit]

// å¼€å¯è‡ªåŠ¨é‡è¿é˜²æ­¢æ‰çº¿
[if] (relogin) == å¼€å¯
  @js WG.zmlfire({"name":"è‡ªåŠ¨é‡è¿","zmlRun":"GM_setValue(role+'_auto_relogin','å¼€')","zmlShow":0,"zmlType":"2"})

stopstate

// å¹³å‡æ–¹å¼æ¨æ¼”é¢„å¤„ç†
[if] (TYPriorNum)==å¹³å‡ || (TYPriorNum)==null
  ($priorNum) = 10
  ($tyType)=æ¨æ¼”æ‰€æœ‰è¯æ¡åˆ° (ZCEntryLv) çº§
[else]
  ($priorNum) = (TYPriorNum)
  ($tyType)=æ¨æ¼”ç¬¬ (priorNum) ä¸ªè¯æ¡åˆ° (ZCEntryLv) çº§
// å¸æ‰å·²è£…å¤‡è‡ªåˆ›éƒ¨ä½
[if] (:kf_nei) == (:id)
  enable force none
[if] (:kf_quan) == (:id)
  enable unarmed none
[if] (:kf_qing) == (:id)
  enable dodge none
[if] (:kf_zhao) == (:id)
  enable parry none
[if] (:kf_jian) == (:id)
  enable sword none
[if] (:kf_dao) == (:id)
  enable blade none
[if] (:kf_zhang) == (:id)
  enable staff none
[if] (:kf_gun) == (:id)
  enable club none
[if] (:kf_bian) == (:id)
  enable whip none
[if] (:kf_an) == (:id)
  enable throwing none

// è®¾å®šæŠ€èƒ½ä½ç½®
($skill)=force
[if] (ZCSkill) == é­æ³•
  ($skill)=whip
[else if] (ZCSkill) == æ–æ³•
  ($skill)=staff
[else if] (ZCSkill) == æ‹›æ¶
  ($skill)=parry
[else if] (ZCSkill) == æ‹³è„š
  ($skill)=unarmed
[else if] (ZCSkill) == æš—å™¨
  ($skill)=throwing
[else if] (ZCSkill) == è½»åŠŸ
  ($skill)=dodge
[else if] (ZCSkill) == æ£æ³•
  ($skill)=club
[else if] (ZCSkill) == å‰‘æ³•
  ($skill)=sword
[else if] (ZCSkill) == åˆ€æ³•
  ($skill)=blade

// è·å–è‡ªåˆ›ç§˜ç±id
[while] (bookID)== null
  zc typedel (skill)
  @tip ç§»é™¤($tag1)>($book)<($tag2)ç±»å‹
  ($bookID)={b(book)}?

// æ˜¯å¦æ¸…ç©ºå·²æœ‰è¯æ¡é‡æ–°æ¨æ¼”
[if] (zcEntrySet) == æ¸…ç©ºé‡æ¨
  @await 2000
  @print <hig>æ ¹æ®è®¾ç½®ï¼Œé‡ç½®<hio>ã€(ZCSkill)ã€‘</hio>éƒ¨ä½è¯æ¡ã€‚</hig>
  zc typedel (skill)
  zc typedel (skill) ok
  zc typedel (skill) ok2
  zc typeadd (skill)
  zc typeadd (skill) ok
  @await 2000
// æ½œèƒ½æœ€å¤§å€¼
($max)=(ZCMaxqn)*10000
// åˆ†è§£è¯æ¡æ•°ç»„
[if](ZCProp)!=null&&(ZCProp)!=none
  @js ($zcp)=("\""+"(ZCProp)"+"\"").replace(/\|/g,"\"|\"").split("|")
//æ˜¾ç¤ºè®¾å®š
($logStart) = å³å°†å¼€å§‹æ¨æ¼”ã€(ZCSkill)ã€‘ï¼Œè®¾å®šè¯æ¡ä¸ºã€(ZCProp)|(ZCSpc)ã€‘ï¼Œ(tyType)ï¼Œè®¾å®šæ€»æ¶ˆè€—æ½œèƒ½ä¸º (ZCMaxqn) ä¸‡ã€‚
@js WG.Send("tm (logStart)")
@print <hic>(logStart)</hic>
// æ”¾é¦™ç‚‰
stopstate
[if] (ZCXlu)!=æ— 
  ($xluNow) = (ZCXlu)
  use {b(xluNow)}?
  @await 500

// å½“å‰ä¸€è½®ç»“æŸåæ˜¯å¦åœæ­¢ï¼ˆfalseåœæ­¢ï¼‰ï¼Œç”Ÿæˆåœæ­¢æ¨æ¼”æŒ‰é’®
($TYEnable)=true
@js $(`.ty_button`).remove();$(`.sm_button`).before(`<span class='zdy-item ty_button'><hio>åœæ­¢æ¨æ¼”</hio></span>`)
@js $('.ty_button').on('click', function(){ToRaid.perform(`//~silent\n($TYEnable)=false\n@print <ord>âš ï¸ ä¸‹ä¸€æ¬¡å‡çº§ååœæ­¢æ¨æ¼”ã€‚</ord>\ntm âš ï¸ ä¸‹ä¸€æ¬¡å‡çº§ååœæ­¢æ¨æ¼”ã€‚`);})
@print <hio>ğŸ‘‡ ç‚¹å‡»ã€åœæ­¢æ¨æ¼”ã€‘å°†åœ¨è¯æ¡ä¸‹ä¸€æ¬¡å‡çº§ååœæ­¢æ¨æ¼”ã€‚</hio>

// ç”ŸæˆæŸ¥çœ‹è¯æ¡å±æ€§æŒ‰é’®
@js $(`.ct_button`).remove();$(`.sm_button`).before(`<span class='zdy-item ct_button'><hig>è¯æ¡å±æ€§</hig></span>`)
@print <hig>ğŸ‘‡ ç‚¹å‡»ã€è¯æ¡å±æ€§ã€‘æŸ¥çœ‹å½“å‰æ¨æ¼”éƒ¨ä½çš„æœ€æ–°è¯æ¡ä¿¡æ¯ã€‚</hig>

// ç”Ÿæˆè¿œç¨‹é€šçŸ¥è®¾ç½®æŒ‰é’®
[if] (AlertTel)==å¼€å¯
  @print âš ï¸ è¿œç¨‹é€šçŸ¥ä¸ºæµ‹è¯•åŠŸèƒ½ï¼Œä½¿ç”¨Serveré…±/Teleé…±æœåŠ¡å®ç°ï¼Œä¸æ‡‚çš„è¯è¯·å‹¿ä½¿ç”¨ï¼Œè‡ªè¡Œæœç´¢äº†è§£ã€‚
  @js $('.WG_log pre').append($(`<div class="item-commands"></div>`).append($(`<span class="alerttel">ğŸ“¢ è¿œç¨‹é€šçŸ¥</span>`)));$('.WG_log')[0].scrollTop = 99999;
  @js $(".alerttel").on("click", function(){ToRaid.perform(`//~silent\n#select ($AlertTel)=æ˜¯å¦å¼€å¯è¿œç¨‹é€šçŸ¥,å¼€å¯|å…³é—­,(AlertTel)\n#select ($AlertTelWay)=é€šçŸ¥æœåŠ¡,Serveré…±|Teleé…±,(AlertTelWay)\n#input ($AlertTelToken)=å¡«å†™é€šçŸ¥æœåŠ¡å¯¹åº”Token,(AlertTelToken)\n#input ($AlertTelUrl)=é€šçŸ¥æœåŠ¡å¯¹åº”Urlï¼ˆåŒ…å«httpsï¼‰,(AlertTelUrl)\n#config`);})

// å¼€å¯æ½œèƒ½ç›‘æ§
@js WG.remove_hook(WG.zcinfo_hook);WG.zcinfo_hook=WG.add_hook('text', data=>data.msg.indexOf('å¢åŠ å…¶å®ƒå¯è£…å¤‡ç±»å‹')>=0?WG.zcinfo=data.msg:0)
@js WG.remove_hook(WG.qn_hook);WG.qn_hook=WG.add_hook('dialog', data=>data.dialog=='score'?WG.qn=data.pot:-1)

// å¼€å§‹
($sum)=0
[while] true
  // åˆ¤æ–­é¦™ç‚‰æƒ…å†µï¼Œè‡ªåŠ¨é€’å¢é¦™ç‚‰ç­‰çº§ã€‚
  [if] (:status xlu,(:id))==false
    [if] (ZCXlu)!=æ— 
      get {r(xluNow)}?
      [while] true
        use {b(xluNow)}?
        @tip ç‚¹ç‡ƒ($one)<($tag1)>($xluNow)</($tag2)>æ”¾åˆ°åœ°ä¸Š|å·²ç»æ²¡æ³•($xluEnd)äº†|ä½ èº«ä¸Š($xluNo)è¿™ä¸ªä¸œè¥¿
        [if] (xluNo) != null || (xluEnd) != null
          ($xlus) = 'æ²‰é¦™æœ¨é¼','éºé¦™é“œé¼','é¾™æ¶é¦™ç†','é¾™è„‘å¤é¼'
          ($xluNo) = null
          ($xluEnd) = null
          @js ($xluN) = var x=[(xlus)];x.indexOf("(xluNow)")
          [if] (xluN)<3
            ($xluN) = (xluN)+1
            @js ($xluNow) = var x=[(xlus)];x[(xluN)]
            @print <hiy>æ›´æ¢é¦™ç‚‰ç±»å‹ä¸ºã€(xluNow)ã€‘ã€‚</hiy>
          [else]
            @print <hiy>é¦™ç‚‰å·²å…¨éƒ¨ç”¨å°½ã€‚</hiy>
            [break]
        [else]
          [break]
  // æ£€æŸ¥å†°å¿ƒé£ç¿¼
  [if] (ZCFood) == æ˜¯ && (:status food)==false && {bå†°å¿ƒä¸¹}? != null
    use {bå†°å¿ƒä¸¹}?
  [if] (ZCFy) == æ˜¯ && (:status fy)==false
    use (:eq0)

  // è®¡ç®—å·²æ¶ˆè€—æ½œèƒ½ã€å·²æ¶ˆè€—ä½†å°šæœªåº”ç”¨åˆ°è¯æ¡ä¸Šçš„å‰©ä½™æ½œèƒ½ã€å‡åˆ°ä¸‹ä¸€çº§æ‰€éœ€æ½œèƒ½
  zc typedel (skill)
  @tip æ­¦é“ä¹¦ï¼Œ($real_cost)æ½œèƒ½ï¼Œ
  [if] (real_cost)>=(max)
    ($logEnd) = å½“å‰(ZCSkill)æ¨æ¼”æ¶ˆè€—æ½œèƒ½ï¼Œå·²è¶…è¿‡è®¾ç½®çš„æ€»æ¶ˆè€—æ½œèƒ½(ZCMaxqn)ä¸‡ã€‚
    @print <hiy>(logEnd)</hiy>
    tm (logEnd)
    ($finish) = 1
    [break]
  packitem zc2 (bookID)
  @await 1000
  @js ($entrys)=WG.zcinfo.match(/å¯è£…å¤‡ä¸º(ZCSkill)(.+?)å¯è£…å¤‡ä¸º|å¯è£…å¤‡ä¸º(ZCSkill)(.+?)å¢åŠ å…¶å®ƒå¯è£…å¤‡ç±»å‹/)[0].match(/\((\d+)\)/g).map(x=>parseInt(x.slice(1, -1)))
  @js ($cost)=eval([(entrys)].map(x=>x*(x-1)*50000).join("+"))
  ($cost) = (cost) + 100000
  [if] (skill) == force && (real_cost) == 0
    ($cost) = (cost) + 100000
  @js ($rest_qn)='(real_cost)'-'(cost)'
  //tm è¯æ¡ç†è®ºæ¶ˆè€—æ€»æ½œèƒ½ã€(cost)ã€‘ï¼Œæ¨æ¼”å®é™…æ¶ˆè€—æ€»æ½œèƒ½ã€(real_cost)ã€‘ï¼Œæœªä½¿ç”¨æ½œèƒ½ã€(rest_qn)ã€‘
  @js ($entry_num)=let l=[(entrys)].length;l<(priorNum)?l:(priorNum)

  // è·å¾—æœ€æ–°è¯æ¡å±æ€§ä¿¡æ¯
  //@js ($entrysInfo)=var ct=WG.zcinfo.replace(/<.*?>/g,"");ct.replace(/[(|)]/g,"\',\'")
  @js ($entrysInfo)=var ct0=WG.zcinfo.replace(/<br\/>/g,"\',\'");var ct1=ct0.replace(/<.*?>/g,"");var ct2=ct1.replace(/\(/g,"ï¼ˆ");ct2.replace(/\)/g,"ï¼‰");
  @js ($entrysInfo) = "(entrysInfo)".replace(/.*å¯è£…å¤‡ä¸º(ZCSkill)ç§»é™¤æå‡å“é˜¶èåˆç»æ‹›\',/g,"")
  @js ($entrysInfo) = "(entrysInfo)".replace(/,\'ç»æ‹›ï¼š.*/g,"")
  @js ($entrysInfo) = "(entrysInfo)".replace(/,\'å¢åŠ å…¶å®ƒå¯è£…å¤‡ç±»å‹.*/g,"")
  //@print (entrysInfo)
  @js ($entrysInfoLen) = [(entrysInfo)].length
  ($num) = 0
  ($entrysData) = è‡ªåˆ›(ZCSkill)å½“å‰å±æ€§ï¼š
  [while] (num) < (entrysInfoLen)
    //@js ($entrysP1) = [(entrysInfo)][(num)]
    //@js ($entrysP2) = [(entrysInfo)][(num)+1]
    //($entrysData) = (entrysData)<br>(entrysP1)ï¼ˆ(entrysP2)ï¼‰
    //($num) = (num) + 2
    @js ($entrysP) = [(entrysInfo)][(num)]
    ($entrysData) = (entrysData)<br>(entrysP)
    ($num) = (num) + 1
  [if] (real_cost_p)==null
    ($real_cost_p) = (real_cost)
    [if] (real_cost_p)>=100000000
      @js ($real_cost_p) = (real_cost_p)/100000000 + 'äº¿'
    [else if] (real_cost_p)>=10000
      @js ($real_cost_p) = (real_cost_p)/10000 + 'ä¸‡'
  [if] (max)>=100000000
    @js ($max_p) = (max)/100000000 + 'äº¿'
  [else if] (max) >=10000
    @js ($max_p) = (max)/10000 + 'ä¸‡'
  @js $(`.ct_button`).off('click');$(`.ct_button`).on('click', function(){ToRaid.perform(`//~silent\n@print <hig>å½“å‰(ZCSkill)æ¨æ¼”è®¾å®šï¼š<br>ğŸ¬ æ¨æ¼”è¯æ¡ï¼š(ZCProp)|(ZCSpc)<br>ğŸ¼ è¯æ¡ä¼˜å…ˆæ¨æ¼”æ–¹å¼ï¼š(TYPriorNum) ğŸ¤ æ¨æ¼”è¯æ¡ç­‰çº§ï¼š(ZCEntryLv) ğŸ” æ€»æ¶ˆè€—æ½œèƒ½ï¼š(max_p)<br>ğŸŸ å·²æ¶ˆè€—æ½œèƒ½ï¼š(real_cost_p)</hig><br>(entrysData)`);})
  
  // åˆ¤æ–­æ˜¯å¦å­˜åœ¨è¢«è¦†ç›–æ½œèƒ½
  @js ($entry_last)=var last=[(entrys)].length-1;[(entrys)][last]*100000
  [if] (rest_qn) > (entry_last)
    @js ($next_qn)=[(entrys)]['(entry_num)'-1]*100000
    //tm âš ï¸ å­˜åœ¨è¦†ç›–è¯æ¡æ½œèƒ½ï¼Œä¸‹ä¸€çº§éœ€è¦ã€(next_qn)ã€‘
  [else]
    @js ($next_qn)=[(entrys)]['(entry_num)'-1]*100000-'(rest_qn)'
    //tm ä¸å­˜åœ¨è¦†ç›–æ½œèƒ½ï¼Œä¸‹ä¸€çº§éœ€è¦ã€(next_qn)ã€‘

  // æŒ‡å®šè¯æ¡ç­‰çº§
  @js ($entrys_len) = [(entrys)].length
  [if] (priorNum)==10
    [if] (entrys_len)==6
      @js ($entrys_last)=[(entrys)][5]
  [else]
    @js ($entrys_last)=[(entrys)]['(priorNum)'-1]
  [if] (entrys_last) != null && (entrys_last) >= (ZCEntryLv) && (ZCEntryLv) != 0 && (ZCEntryLv) != null
    ($logEnd) = å·²è¾¾åˆ°é¢„è®¾è¯æ¡ç­‰çº§ã€(ZCEntryLv)ã€‘ï¼Œåœæ­¢æ¨æ¼”ã€‚
    @print <hio>(logEnd)</hio>
    tm (logEnd)
    ($finish)=3
    [break]

  // å¼€å§‹æ¨æ¼”
  [if] (finish) == null
    zc typelv (skill)
    ($prop)=null
    ($gdbug) = null
    @tip ç›˜è†åä¸‹|å±æ€§ï¼š($gd)<cyn>($prop)<|å±æ€§ï¼š($gdbug)æ”¾å¼ƒ
  [if](prop)!=null
    [if](sum)==1
      ($sum)=2
    ($add)=-1
    // åˆ¤æ–­æ˜¯å¦æ·»åŠ æ–°è¯æ¡
    [if](ZCProp)!=null&&(ZCProp)!=none
      @js ($num)=[(zcp)].length
      [while] (num)>0
        ($num)=(num)-1
        @js ($op)=[(zcp)][(num)]
        @js ($propZhen)="(prop)".indexOf("é™„è¿‘æ•Œäºº")
        [if] (propZhen)!=-1
          @js ($zhenshe)="(op)".indexOf("éœ‡æ…‘")
          [if] (zhenshe)!=-1
            [if] (op)==éœ‡æ…‘ï¼ˆé•¿ç”Ÿï¼‰
              ($op)=ä¼¤å®³
            [else if] (op)==éœ‡æ…‘ï¼ˆæ…ˆèˆªï¼‰
              ($op)=èº²é—ªå’Œæ‹›æ¶
            [else if] (op)==éœ‡æ…‘ï¼ˆæˆ˜ç¥ï¼‰
              ($op)=é˜²å¾¡å’Œå…ä¼¤
            @js ($add)="(prop)".indexOf("(op)")
        [else]
          @js ($pe)="(op)".search(/.*%/)
          [if] (pe)!=-1
            @js ($op)="(op)".replace("%","")
            @js ($add)="(prop)".search(/(op)ï¼š.*%/)
          [else]
            @js ($pe)="(op)".search(/.*d/)
            [if] (pe)!=-1
              @js ($op)="(op)".replace("d","")
              @js ($ps)="(prop)".search(/(op)ï¼š.*%/)
              [if] (ps)==-1
                @js ($add)="(prop)".indexOf("(op)"+"ï¼š")
            [else]
              @js ($add)="(prop)".indexOf("(op)"+"ï¼š")
        [if] (add) !=-1
          [break]
    [if] (add)==-1 && (ZCSpc) !=null
      @js ($add)="(prop)".indexOf("(ZCSpc)")
      [if] (add) !=-1 && (ZCxl) == æ˜¯
        ($xl)=1
    // æ·»åŠ æˆ–æ”¾å¼ƒè¯æ¡
    [if] (add) !=-1
      zc prop (skill) add
      @tip å¢åŠ å±æ€§|ä¸èƒ½å†æ·»åŠ ($finish)
      [if] (finish) == null
        ($logProp) = æ·»åŠ è¯æ¡ã€(prop)ã€‘
      [else]
        ($logProp) = è¯æ¡å·²æ»¡ï¼Œæ— æ³•æ·»åŠ ã€(prop)ã€‘
      @js WG.Send("tm ğŸ’¡ (logProp) (:hour):(:minute):(:second)")
      @print <hio>(logProp)</hio>
      [if] (ZCAlertType)==å…¨éƒ¨é€šçŸ¥
        [if] (ZCAlertWay)==è¯­éŸ³æ’­æŠ¥
          $tts (:name)ï¼Œ(logProp)
        [else if] (ZCAlertWay)==æç¤ºéŸ³
          @beep
        // è¿œç¨‹é€šçŸ¥
        [if] (AlertTel) == å¼€å¯ && (AlertTelToken) != null
          [if] (AlertTelWay) == Teleé…±
            @js $.post(`https://(AlertTelUrl)/api/send?sendkey=(AlertTelToken)&text=ã€æ¨æ¼”ã€‘(:name)(logProp)`)
          [else if] (AlertTelWay) == Serveré…±
            ($AlertTelUrl) = sctapi.ftqq.com
            @js $.post(`https://(AlertTelUrl)/(AlertTelToken).send?title=ã€æ¨æ¼”ã€‘(:name)(logProp)`)
        
    [else]
      zc prop (skill) ban
      @js WG.Send("tm æ”¾å¼ƒè¯æ¡ã€(prop)ã€‘ (:hour):(:minute):(:second)")
    ($gdbug) = null
  [if] (gdbug) != null
    zc prop (skill) ban
    @print æ”¾å¼ƒå› bugå¯¼è‡´çš„æœªçŸ¥è¯æ¡ (:hour):(:minute):(:second)
    @js WG.Send("tm æ”¾å¼ƒå› bugå¯¼è‡´çš„æœªçŸ¥è¯æ¡ (:hour):(:minute):(:second)")
  // æ½œèƒ½æ¶ˆè€—å€¼
  [if](sum)==2
    zc typedel (skill)
    @tip æ­¦é“ä¹¦ï¼Œ($qn)æ½œèƒ½ï¼Œ
    [if] (qn)>=(max) || (xl) == 1
      ($finish)=1
    ($sum)=0
  // å·²æ¨å‡ºç‰¹æ®Šè¯æ¡åçš„åŠ¨ä½œ
  [if] (xl) == 1
    ($logEnd) = å·²æ¨å‡ºç‰¹æ®Šè¯æ¡ï¼Œåœæ­¢æ¨æ¼”ã€‚
    tm (logEnd)
    @print <hio>(logEnd)</hio>
    [break]
  // å¾ªç¯æ¨æ¼”
  ($num) =1
  ($real_cost_p) = (real_cost)
  [if] (real_cost_p)>=100000000
    @js ($real_cost_p) = (real_cost_p)/100000000 + 'äº¿'
  [else if] (real_cost_p)>=10000
    @js ($real_cost_p) = (real_cost_p)/10000 + 'ä¸‡'
  ($rest_qn_p) = (rest_qn)
  [if] (rest_qn_p)>=10000
    @js ($rest_qn_p) = (rest_qn_p)/10000 + 'ä¸‡'
  ($next_qn_p) = (next_qn)
  [if] (next_qn_p)>=10000
    @js ($next_qn_p) = (next_qn_p)/10000 + 'ä¸‡'
  tm è‡ªåˆ›(ZCSkill)æ½œèƒ½ã€(real_cost_p)ã€‘ï¼Œæœªä½¿ç”¨æ½œèƒ½ã€(rest_qn_p)ã€‘ï¼Œè¯æ¡ç­‰çº§ã€(entrys)ã€‘ (:hour):(:minute):(:second);
  tm æ¨æ¼”(ZCSkill)ç¬¬ã€(entry_num)ã€‘æ¡å±æ€§ï¼Œå‡çº§éœ€è¦ã€(next_qn_p)ã€‘æ½œèƒ½ (:hour):(:minute):(:second);
  ($start_qn)=null
  ($trytime)=500
  [while] (start_qn)==null
    score
    @await (trytime)
    @js ($start_qn)=WG.qn
    [if] (start_qn)==null
      ($trytime) = (trytime) + 500
  // åˆ¤æ–­å‰©ä½™æ½œèƒ½æ˜¯å¦å¤Ÿè¯æ¡æ¨æ¼”åˆ°ä¸‹ä¸€çº§
  [if] (start_qn) < (next_qn) && (start_qn) != null && (next_qn) != null
    ($logEnd) = å½“å‰å‰©ä½™æ½œèƒ½ã€(start_qn)ã€‘ï¼Œæ— æ³•å‡çº§è¯æ¡åˆ°ä¸‹ä¸€çº§ï¼Œåœæ­¢æ¨æ¼”ã€‚
    @print <hiy>(logEnd)</hiy>
    tm (logEnd)
    ($finish)=2
    stopstate
    [break]
  [while] (:state)==æ¨æ¼”
    @tip æœ‰äº†æ›´æ·±å…¥çš„ç†è§£|æ½œèƒ½ä¸å¤Ÿ($finish)
    ($now_qn)=null
    ($trytime)=500
    [while] (now_qn)==null
      score
      @await (trytime)
      @js ($now_qn)=WG.qn
      [if] (now_qn)==null
        ($trytime) = (trytime) + 500
        [if] (trytime) >= 2000
          ($trytime) = 500

    ($done_qn)=(start_qn)-(now_qn)
    ($done_qn_p)=(done_qn)
    [if] (done_qn_p)>=10000
      @js ($done_qn_p) = (done_qn_p)/10000 + 'ä¸‡'
    say å·²æ¨æ¼”ã€(done_qn_p)ã€‘æ½œèƒ½ï¼Œå‡çº§éœ€è¦ã€(next_qn_p)ã€‘æ½œèƒ½ (:hour):(:minute):(:second)
    [if] (done_qn) >= (next_qn) || (finish) != null
      ($num) = 0
      [if](sum)==0
        ($sum)=1
      stopstate
      [break]
  
  // æ ¹æ®TYEnableåˆ¤æ–­æ˜¯å¦ç»§ç»­æ¨æ¼”
  [if] (TYEnable)==false || (finish)!=null
    ($logEnd) = è¯æ¡å·²å‡çº§ï¼Œåœæ­¢æ¨æ¼”ã€‚
    @print <hio>(logEnd)</hio>
    tm (logEnd)
    [break]
// æ”¶èµ·é¦™ç‚‰
[if] (ZCXlu)!=æ— 
  get {r(xluNow)}?
xiulian
[if] (ZCAlertType) != å…³é—­
  [if] (ZCAlertWay)==è¯­éŸ³æ’­æŠ¥
    $tts (:name)ï¼Œæ¨æ¼”å·²ç»“æŸ
  [else if] (ZCAlertWay)==æç¤ºéŸ³
    @beep
  // è¿œç¨‹é€šçŸ¥
  [if] (AlertTel) == å¼€å¯ && (AlertTelToken) != null
    [if] (AlertTelWay) == Teleé…±
      @js $.post(`(AlertTelUrl)/api/send?sendkey=(AlertTelToken)&text=ã€æ¨æ¼”ã€‘(:name)(logEnd)`)
    [else if] (AlertTelWay) == Serveré…±
      ($AlertTelUrl) = https://sctapi.ftqq.com
      @js $.post(`(AlertTelUrl)/(AlertTelToken).send?title=ã€æ¨æ¼”ã€‘(:name)(logEnd)`)

@js WG.remove_hook(WG.zcinfo_hook);WG.remove_hook(WG.qn_hook);$(`.ty_button`).remove();$(`.ct_button`).remove();